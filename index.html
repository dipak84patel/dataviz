<!DOCTYPE html>
<html>

<head>

  <title>CS498-Data Visualization Final Project</title>

  <!-- Required stylesheet -->
  <link rel="stylesheet" type="text/css" href="stylesheet.css">

  

</head>

<body>

    <div class="slideshow-container">

      <div class="mySlides fade">
      <div class="numbertext">1 / 3</div>

      <h1 style="font-size:400%;"><u>U.S. GUN VIOLENCE 2013-2018</u></h1>
      <h3 style="font-size:300%;">By Dipak Patel:</h1>
    
      <div class="a">The United States experiences epidemic levels of gun violence, claiming over 30,000 lives
        annually, according to the U.S. Centers for Disease Control and Prevention. For every person
        who dies from a gunshot wound, two others are wounded. Every year, approximately 100,000 Americans 
        are victims of gun violence. In addition to those who are killed or injured, there are countless 
        others whose lives are forever changed by the deaths of and injured to their loved ones. With the help 
        of <a href="https://www.kaggle.com/amitb1002/gun-violence-data-2013-2018/data">kaggle</a> where I received the data from. 
        I was able to help visualize some of the data to answer these questions</div>
       
      </div>

        <!-- <a href="#" class="previous round">&#8249;</a>
        <a href="#" class="next round">&#8250;</a> -->
      
 
        <div class="mySlides fade">
            <div class="numbertext">2 / 3</div>

      <h2>Hybrid Structure</h2>
      <div class="b">This narrative visualization is in the form of interactive slideshow which allows audience to follow a story
        that I have created and dive into details at their leisure.
      </div>

      <h2>Scenes</h2>
      <div class="b">
       In order to follow visual consistency in slideshow I have used external stylesheet customization. With the help of other add-ons and
       libraries I was able to maintain visual consistency throughout the presentation.
      </div>


      <h2>Annotations</h2>
      <div class="b">
       As the user hover mouse over different charts they are able to see gun violence data by month, Number of people Killed, Number of people Injured,
       Number of Guns Involved. Similar trend of gun violence data can be viewed in different charts. 
       
      </div>

      <h2>Parameters</h2>
      <div class="b">
       I used parameters to filter the gun violence data by N Killed, N Injured, N of Gun Involved by different state. Different scenes can be visualized
       using different parameters. 
       
      </div>
      


      <h2>Triggers</h2>
      <div class="b">
       There are buttons linked to the change in annotations/scenes in order to visualize gun violence data from 2013-2018.
       
      </div>
        </div>


      <div class="mySlides fade">
          <div class="numbertext">3 / 4</div>
          <h1 style="font-size:400%;"><u>Gun Violence Attacks</u></h1>
          <div class="chart">
            </div>
   

    </div>
    
      
      </div>

              <!-- Next and previous buttons -->
  <a class="prev" onclick="plusSlides(-1)">&#10094;</a>
  <a class="next" onclick="plusSlides(1)">&#10095;</a> 
    </div>
    <br>

    <div style="text-align:center">
        <span class="dot" onclick="currentSlide(1)"></span> 
        <span class="dot" onclick="currentSlide(2)"></span> 
        <span class="dot" onclick="currentSlide(3)"></span> 
        <span class="dot" onclick="currentSlide(4)"></span> 
      </div>

    <script>
        var slideIndex = 1;
        showSlides(slideIndex);
        
        function plusSlides(n) {
          showSlides(slideIndex += n);
        }
        
        function currentSlide(n) {
          showSlides(slideIndex = n);
        }
        
        function showSlides(n) {
          var i;
          var slides = document.getElementsByClassName("mySlides");
          var dots = document.getElementsByClassName("dot");
          if (n > slides.length) {slideIndex = 1}    
          if (n < 1) {slideIndex = slides.length}
          for (i = 0; i < slides.length; i++) {
              slides[i].style.display = "none";  
          }
          for (i = 0; i < dots.length; i++) {
              dots[i].className = dots[i].className.replace(" active", "");
          }
          slides[slideIndex-1].style.display = "block";  
          dots[slideIndex-1].className += " active";
        }
        
        </script>
      
      <script src="http://d3js.org/d3.v2.js"></script>
      


      <script>

          chart("data.csv", "orange");
          
          var datearray = [];
          var colorrange = [];
          
          
          function chart(csvpath, color) {
          
          if (color == "blue") {
            colorrange = ["#045A8D", "#2B8CBE", "#74A9CF", "#A6BDDB", "#D0D1E6", "#F1EEF6"];
          }
          else if (color == "pink") {
            colorrange = ["#980043", "#DD1C77", "#DF65B0", "#C994C7", "#D4B9DA", "#F1EEF6"];
          }
          else if (color == "orange") {
            colorrange = ["#B30000", "#E34A33", "#FC8D59", "#FDBB84", "#FDD49E", "#FEF0D9"];
          }
          strokecolor = colorrange[0];
          
          var format = d3.time.format("%m/%d/%y");
          
          var margin = {top: 20, right: 40, bottom: 30, left: 30};
          var width = document.body.clientWidth - margin.left - margin.right;
          var height = 400 - margin.top - margin.bottom;
          
          var tooltip = d3.select("body")
              .append("div")
              .attr("class", "remove")
              .style("position", "absolute")
              .style("z-index", "20")
              .style("visibility", "hidden")
              .style("top", "30px")
              .style("left", "55px");
          
          var x = d3.time.scale()
              .range([0, width]);
          
          var y = d3.scale.linear()
              .range([height-10, 0]);
          
          var z = d3.scale.ordinal()
              .range(colorrange);
          
          var xAxis = d3.svg.axis()
              .scale(x)
              .orient("bottom")
              .ticks(d3.time.weeks);
          
          var yAxis = d3.svg.axis()
              .scale(y);
          
          var yAxisr = d3.svg.axis()
              .scale(y);
          
          var stack = d3.layout.stack()
              .offset("silhouette")
              .values(function(d) { return d.values; })
              .x(function(d) { return d.date; })
              .y(function(d) { return d.value; });
          
          var nest = d3.nest()
              .key(function(d) { return d.key; });
          
          var area = d3.svg.area()
              .interpolate("cardinal")
              .x(function(d) { return x(d.date); })
              .y0(function(d) { return y(d.y0); })
              .y1(function(d) { return y(d.y0 + d.y); });
          
          var svg = d3.select(".chart").append("svg")
              .attr("width", width + margin.left + margin.right)
              .attr("height", height + margin.top + margin.bottom)
            .append("g")
              .attr("transform", "translate(" + margin.left + "," + margin.top + ")");
          
          var graph = d3.csv(csvpath, function(data) {
            data.forEach(function(d) {
              d.date = format.parse(d.date);
              d.value = +d.value;
            });
          
            var layers = stack(nest.entries(data));
          
            x.domain(d3.extent(data, function(d) { return d.date; }));
            y.domain([0, d3.max(data, function(d) { return d.y0 + d.y; })]);
          
            svg.selectAll(".layer")
                .data(layers)
              .enter().append("path")
                .attr("class", "layer")
                .attr("d", function(d) { return area(d.values); })
                .style("fill", function(d, i) { return z(i); });
          
          
            svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + height + ")")
                .call(xAxis);
          
            svg.append("g")
                .attr("class", "y axis")
                .attr("transform", "translate(" + width + ", 0)")
                .call(yAxis.orient("right"));
          
            svg.append("g")
                .attr("class", "y axis")
                .call(yAxis.orient("left"));
          
            svg.selectAll(".layer")
              .attr("opacity", 1)
              .on("mouseover", function(d, i) {
                svg.selectAll(".layer").transition()
                .duration(250)
                .attr("opacity", function(d, j) {
                  return j != i ? 0.6 : 1;
              })})
          
              .on("mousemove", function(d, i) {
                mousex = d3.mouse(this);
                mousex = mousex[0];
                var invertedx = x.invert(mousex);
                invertedx = invertedx.getMonth() + invertedx.getDate();
                var selected = (d.values);
                for (var k = 0; k < selected.length; k++) {
                  datearray[k] = selected[k].date
                  datearray[k] = datearray[k].getMonth() + datearray[k].getDate();
                }
          
                mousedate = datearray.indexOf(invertedx);
                pro = d.values[mousedate].value;
          
                d3.select(this)
                .classed("hover", true)
                .attr("stroke", strokecolor)
                .attr("stroke-width", "0.5px"), 
                tooltip.html( "<p>" + d.key + "<br>" + pro + "</p>" ).style("visibility", "visible");
                
              })
              .on("mouseout", function(d, i) {
               svg.selectAll(".layer")
                .transition()
                .duration(250)
                .attr("opacity", "1");
                d3.select(this)
                .classed("hover", false)
                .attr("stroke-width", "0px"), tooltip.html( "<p>" + d.key + "<br>" + pro + "</p>" ).style("visibility", "hidden");
            })
              
            var vertical = d3.select(".chart")
                  .append("div")
                  .attr("class", "remove")
                  .style("position", "absolute")
                  .style("z-index", "19")
                  .style("width", "1px")
                  .style("height", "380px")
                  .style("top", "10px")
                  .style("bottom", "30px")
                  .style("left", "0px")
                  .style("background", "#fff");
          
            d3.select(".chart")
                .on("mousemove", function(){  
                   mousex = d3.mouse(this);
                   mousex = mousex[0] + 5;
                   vertical.style("left", mousex + "px" )})
                .on("mouseover", function(){  
                   mousex = d3.mouse(this);
                   mousex = mousex[0] + 5;
                   vertical.style("left", mousex + "px")});
          });
          }
          </script>


</body>